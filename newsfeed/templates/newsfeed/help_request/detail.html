{% extends "core/base.html" %}

{% block content %}

{% include "newsfeed/t/tHelpRequest.html" %}

<br>

{% if modelHelpRequest.boolWasRespondedTo %}
	<div class = "container border rounded p-3">
		<p>To be helped by user <strong>{{modelHelpRequest.accepted_user.username}}.</strong></p>
		<a href = "{{modelHelpRequest.accepted_user.get_public_profile_url}}">
			<p>
				View <strong>{{modelHelpRequest.accepted_user.username}}</strong>'s profile.
			</p>
		</a>
		<a href = "{% url 'users:dm-detail' modelHelpRequest.accepted_user %}">
			<p>
				Or direct message them.
			</p>
		</a>
		<a href = "{% url 'users:help-request-offer-remove-prepare' user.username modelHelpRequest.slug  %}" class = 'text-danger'>
			<p>
				Remove user {{modelHelpRequest.accepted_user.username}} from your help request?
			</p>
		</a>
	</div>
{% elif request.user != modelHelpRequest.author %}
	{% if request.user not in modelHelpRequest.listGetOfferUsers %}
		<div class = "container border border rounded p-3">
			<h4>Think you can help out?</h4>
			<p class = "text-muted">Send a direct message to begin the conversation.</p>
			<div>
				<form method = "POST" action = "{% url 'newsfeed:help-request-offer-create' modelHelpRequest.author.username modelHelpRequest.slug %}">
					{% csrf_token %}
					<label class = "text-muted" for="text_content">Write a brief introduction. Let them know why you can help.</label>
					<textarea name='text' class = "form-control" rows = 4></textarea>
					<br>
					<div class = "container">
						<div class = "row">
							<button type= "submit" class = "btn btn-primary">Submit</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	{% else %}
		<div class = "container border rounded p-3">
			<h4>You have already created a help request offer.</h4>
			<p>
				If you would like to create a new one, you must 
				<a href = "{% url 'newsfeed:help-request-offer-delete' modelHelpRequest.author.username modelHelpRequest.slug modelHelpRequestOffer.id %}" class = 'text-danger'>delete</a> the old one.
			</p>
			<hr>
			<h5>
				Your last created offer:
			</h5>
			{% include 'newsfeed/t/tHelpRequestOfferThumb.html' %}

		</div>
	{% endif %}
{% else %}
<div class = "container border rounded p-3">
	<h4 class = 'text-center'>Your Offers</h4>
	{% if listmodelHelpRequestOffers|length == 0 %}
		<p class = 'text-center'>No offers yet.</p>
	{% else %}
		{% for modelHelpRequestOffer in listmodelHelpRequestOffers %}
			<div class = "container border  rounded p-3">
				<a href = "{{modelHelpRequestOffer.get_absolute_url}}">
					<p>Offer by {{modelHelpRequestOffer.author}} on {{modelHelpRequest.pub_date}}</p>
				</a>
			</div>
		{% endfor %}
	{% endif %}
	</div>
{% endif %}

{% endblock %}
